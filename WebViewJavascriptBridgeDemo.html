<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="user-scalable=no, width=device-width, initial-scale=1.0, maximum-scale=1.0">
    <style type='text/css'>
        html {
            font-family: Helvetica;
            color: #222;
        }

        button {
            margin: 0 3px 10px;
            font-size: 20px;
        }

        .logLine {
            border-bottom: 1px solid #ccc;
            padding: 4px 2px;
            font-family: courier;
            font-size: 11px;
        }
    </style>
    <title>WebViewJavascriptBridge Demo</title>
</head>
<body>
<script>

    //与iOS WebView建立连接
    function connectWebViewJavascriptBridge(callback) {
        if (window.WebViewJavascriptBridge) {
            callback(WebViewJavascriptBridge)
        } else {
            document.addEventListener('WebViewJavascriptBridgeReady', function () {
                callback(WebViewJavascriptBridge)
            }, false)
        }
    }

    connectWebViewJavascriptBridge(function (bridge) {
        //初始化bridge(message为收到的来自WebView的消息，responseCallback为对该消息的回调)
        bridge.init(function (message, responseCallback) {

        });

        //向WebView传递信息（data为发送的信息，此处为一个图片的url；responseData为Webview的响应信息）
        var button = document.getElementById('buttons').appendChild(document.createElement('button'));
        button.innerHTML = '发送分享图片URL';
        button.onclick = function (e) {
            e.preventDefault();
            var data = {'shareImageUrl': 'http://ca.bidadaijia.com/ios_zf/test/images/share.jpg'};
            bridge.send(data, function (responseData) {

            })
        };

        //向WebView传递信息（data为发送的信息，此处为一个图片的url；responseData为Webview的响应信息）
        var button = document.getElementById('buttons').appendChild(document.createElement('button'));
        button.innerHTML = '隐藏分享按钮';
        button.onclick = function (e) {
            e.preventDefault();
            var data = {'hideShareButton': true};
            bridge.send(data, function (responseData) {

            })
        };

        document.body.appendChild(document.createElement('br'));
        //调用iOS原生函数（函数名必须事先约定）
        //叫单
        var createOrderButton = document.getElementById('buttons').appendChild(document.createElement('button'));
        createOrderButton.innerHTML = '现在叫代驾';
        createOrderButton.onclick = function (e) {
            e.preventDefault();
            bridge.callHandler('createOrder', function (response) {

            });
        };
        document.body.appendChild(document.createElement('br'));
        //获取用户手机号码
        var getPhoneButton = document.getElementById('buttons').appendChild(document.createElement('button'));
        getPhoneButton.innerHTML = '获取用户手机号';
        getPhoneButton.onclick = function (e) {
            e.preventDefault();
            bridge.callHandler('getUserPhone', {}, function (response) {
                alert(response);

            });
        };
        document.body.appendChild(document.createElement('br'));
        //返回主页
        var gotoMainButton = document.getElementById('buttons').appendChild(document.createElement('button'));
        gotoMainButton.innerHTML = '返回主页';
        gotoMainButton.onclick = function (e) {
            e.preventDefault();
            bridge.callHandler('pageJump', "main", function (response) {

            });
        };
        document.body.appendChild(document.createElement('br'));
        //跳转到优惠券列表页面
        var gotoCouponListButton = document.getElementById('buttons').appendChild(document.createElement('button'));
        gotoCouponListButton.innerHTML = '优惠券列表';
        gotoCouponListButton.onclick = function (e) {
            e.preventDefault();
            bridge.callHandler('pageJump', "couponList", function (response) {

            });
        };
        document.body.appendChild(document.createElement('br'));
        //跳转到优惠券列表页面
        var gotoWalletButton = document.getElementById('buttons').appendChild(document.createElement('button'));
        gotoWalletButton.innerHTML = '充值界面';
        gotoWalletButton.onclick = function (e) {
            e.preventDefault();
            bridge.callHandler('pageJump', "wallet", function (response) {

            });
        };
        //调用分享功能
        var shareButton = document.getElementById('buttons').appendChild(document.createElement('button'));
        shareButton.innerHTML = '分享';
        shareButton.onclick = function (e) {
            e.preventDefault();
            bridge.callHandler('shareAction', {
                'aps': {'alert': '我是分享标题'},
                'extras': '我是分享的详情',
                'ActivityUrl': 'http://wap.aidaijia.com'
            }, function (response) {

            });
        }
    });
</script>
<div id="buttons"></div>
<div id="log"></div>
</body>
</html>